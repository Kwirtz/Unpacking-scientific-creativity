---
title: 'Author perspective'
author: "Kevin Wirtz (kevin.wirtz@unistra.fr)"
date: "Updated `r format(Sys.time(), '%B %d, %Y')`"
output:
  html_notebook:
    code_folding: hide
    df_print: paged
    toc: true
    toc_depth: 2
    toc_float:
      collapsed: false
    theme: flatly
---

```{r setup, include=FALSE}

rm(list = ls(all.names = TRUE)) #will clear all objects includes hidden objects.
gc() #free up memrory and report the memory usage.
graphics.off()

Sys.setenv(LANG = "en") # For english language
options(scipen = 5) # To deactivate annoying scientific number notation

### Load packages
library(tidyverse) # Collection of all the good stuff like dplyr, ggplot2 ect.
library(magrittr) # For extra-piping operators (eg. %<>%)
library(glue)
# Descriptives
#library(skimr)
library(stargazer)
library(corrplot)
# ML
library(xgboost)
library(caret)  
library(caTools)
library(e1071)
```

Link between authors and perceived novelty

Import data
```{r} 
df = read_rds(file = "../../Data/regression_2.rds")
```

define dependant variables
```{r} 
novelty_cat <- c("Technical Advance","Interesting Hypothesis","Novel Drug Target")
independant <-  c("author_intra_abstract","author_inter_abstract", "author_intra_title", "author_inter_title")
independant_fw <- paste0(independant, "_fw")
variables <- c("nb_ref", "nb_meshterms", "year", "nb_aut", "journal_SJR", "is_review", "journal_age","sum_deg_cen_cumsum")
```

################################################################################
####################### Abstract on logit ######################################
################################################################################

```{r} 


mod_1 = glm(novel_f1000 ~ author_intra_abstract_fw + author_inter_abstract_fw+
           nb_ref + nb_meshterms + year + nb_aut + journal_SJR + is_review + journal_age + sum_deg_cen_cumsum,
                                              data = df, family=binomial(link = "logit"))
stargazer(mod_1,
          type = 'text', omit = variables)

```


################################################################################
####################### Abstract on Poisson ####################################
################################################################################

```{r} 


mod_1 = glm(Technical_Advance ~ author_intra_abstract_fw + author_inter_abstract_fw+
           nb_ref + nb_meshterms + year + nb_aut + journal_SJR + is_review + journal_age + sum_deg_cen_cumsum,
                                              data = df, family="poisson")

mod_2 = glm(Interesting_Hypothesis ~ author_intra_abstract_fw + author_inter_abstract_fw+
           nb_ref + nb_meshterms + year + nb_aut + journal_SJR + is_review + journal_age + sum_deg_cen_cumsum,
                                              data = df, family="poisson")

mod_3 = glm(Novel_Drug_Target ~ author_intra_abstract_fw + author_inter_abstract_fw+
           nb_ref + nb_meshterms + year + nb_aut + journal_SJR + is_review + journal_age + sum_deg_cen_cumsum,
                                              data = df, family="poisson")

stargazer(mod_1, mod_2, mod_3,
          type = 'text', omit = variables)

```

################################################################################
####################### Title on logit #########################################
################################################################################

```{r} 


mod_1 = glm(novel_f1000 ~ author_intra_title_fw + author_inter_title_fw+
           nb_ref + nb_meshterms + year + nb_aut + journal_SJR + is_review + journal_age + sum_deg_cen_cumsum,
                                              data = df, family=binomial(link = "logit"))
stargazer(mod_1,
          type = 'text', omit = variables)

```

################################################################################
####################### Title on Poisson #######################################
################################################################################

```{r} 
mod_1 = glm(Technical_Advance ~ author_intra_title_fw + author_inter_title_fw+
           nb_ref + nb_meshterms + year + nb_aut + journal_SJR + is_review + journal_age + sum_deg_cen_cumsum,
                                              data = df, family="poisson")

mod_2 = glm(Interesting_Hypothesis ~ author_intra_title_fw + author_inter_title_fw+
           nb_ref + nb_meshterms + year + nb_aut + journal_SJR + is_review + journal_age + sum_deg_cen_cumsum,
                                              data = df, family="poisson")

mod_3 = glm(Novel_Drug_Target ~ author_intra_title_fw + author_inter_title_fw+
           nb_ref + nb_meshterms + year + nb_aut + journal_SJR + is_review + journal_age + sum_deg_cen_cumsum,
                                              data = df, family="poisson")

stargazer(mod_1, mod_2, mod_3,
          type = 'text', omit = variables)
```